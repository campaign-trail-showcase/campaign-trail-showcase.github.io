 //* Mod Title: 2016 - Tough As Texas
 //* Mod Author: TheMcCain
 //* Mod Version: 1.0
 //* 
 //* Coding License: Apache License 2.0
 //* Writing License: Creative Commons Attribution 4.0 International (CC BY 4.0)
 //* 
 //* For the coding in this mod, I hereby release the code under the terms and conditions of the Apache License 2.0. The full text of the license can be found at:
 // * https://choosealicense.com/licenses/apache-2.0/
 //* 
 // * For the writing in this mod, including documentation, text files, and other non-software written works, I hereby release the content under the terms and conditions of the Creative Commons Attribution 4.0 International (CC BY 4.0) license. The full text of the license can be found at:
 // * https://creativecommons.org/licenses/by/4.0/legalcode
 // * 
 // Tags: Althist

function addColor() { // Change color checkbox, thank you astro
    var difficultyDiv = document.getElementById("difficulty_level");
    if (difficultyDiv && !document.getElementById("colour")) { // Prevent multiple additions

        // Colour selection form
        var colourForm = document.createElement("form");
        colourForm.name = "colour_selection";

        var colourHeader = document.createElement("h3");
        colourHeader.textContent = "Enable alternate colors?";
        colourForm.appendChild(colourHeader);

        var colourCheckbox = document.createElement("input");
        colourCheckbox.type = "checkbox";
        colourCheckbox.id = "colour";
        colourCheckbox.checked = false;
        colourForm.appendChild(colourCheckbox);

        difficultyDiv.appendChild(colourForm);

        // Colour checkbox logic
        colourCheckbox.addEventListener("change", function() {
            var c = campaignTrail_temp.candidate_json;
            if (!c || c.length < 2) return;

            if (this.checked) {
                c[0].fields.color_hex = '#103282';
                c[0].fields.secondary_color_hex = '#cf001f';
                c[1].fields.color_hex = '#960218';
                c[1].fields.secondary_color_hex = '#0222c4';
            }
        });

        // Adjust difficulty header safely
        var difficultyForm = document.querySelector('form[name="difficulty_level_selection"]');
        if (difficultyForm) {
            var difficultyHeader = difficultyForm.querySelector('h3');
            if (difficultyHeader) {
                difficultyHeader.textContent = "Select campaign difficulty:";
            }
        }

        // Style forms safely
        var forms = difficultyDiv.querySelectorAll("form");
        forms.forEach(f => {
            f.style.display = "inline-block";
            f.style.paddingLeft = "10px";
            f.style.paddingRight = "10px";
        });
    }
}

// Observer wrapper
if(!campaignTrail_temp.observer){
    campaignTrail_temp.observer = true;

    let masterObserver = new MutationObserver(function() {
        masterObserver.disconnect();
        addColor();
        masterObserver.observe(document.body, { childList: true, subtree: true });
    });

    masterObserver.observe(document.body, { childList: true, subtree: true });
}



function updateSiteCredits() {
  const heading = document.querySelector("div#site_credits p");
  if (heading) {
    heading.innerHTML = "All DBA award images created by cherrymeringue!<br>Thanks for playing Tough as Texas!";
  }
}

let changesInProgress = false;
let masterObserver = new MutationObserver(masterFunction);
function masterFunction() {
        if (changesInProgress) return;
        changesInProgress = true;
        masterObserver.disconnect();

        // Call all the functions here
        updateSiteCredits();

        // Re-observe the document
        changesInProgress = false;
        masterObserver.observe(document.body, { childList: true, subtree: true });
}
masterObserver.observe(document.body, { childList: true, subtree: true });

// Global text variables
e.SelectText = 'Please confirm you will play:';
e.CandidText = 'Please select your Presidential nominee:';
e.VpText = 'Please select your Vice Presidential nominee:';
e.HomeStateText = "Position:";
e.PartyText = "Affiliation:";
e.ElectionPopup = "Election night is here. Good luck, you've fought a brave battle."
e.LosePopup = "The people of this country have decided. They have chosen radicalism over decency..."
e.WinPopup = "The people of this country have decided. They have chosen decency over radicalism!"

// Favicon

document.querySelectorAll("link[rel*='icon']").forEach(el => el.remove());

const favican = document.createElement("link");
favican.rel = "icon";
favican.type = "png";
favican.href = "https://i.imgur.com/zUGKrED.png";

document.head.appendChild(favican);

// Advisor feedback animation

document.head.innerHTML += `
<style>
  @keyframes fadeInScale {
    0% {
      opacity: 0;
      transform: scale(0.95);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  @keyframes hologlow {
    0% {
      box-shadow: 0 0 8px rgba(174, 234, 255, 0.4),
                  0 0 20px rgba(174, 234, 255, 0.2);
    }
    100% {
      box-shadow: 0 0 16px rgba(174, 234, 255, 0.7),
                  0 0 40px rgba(174, 234, 255, 0.4);
    }
  }

  .overlay_window {
    animation: fadeInScale 0.3s cubic-bezier(0.3, 1.2, 0.2, 1) forwards,
               gradientShift 30s ease infinite,
               hologlow 1s ease-in-out infinite alternate;
    opacity: 0;
    background: linear-gradient(135deg, #1a1a1a, #222222, #2e2e2e);
    background-size: 300% 300%;
    border-radius: 0.7rem;
    box-shadow:
      0 0 1.2em rgba(174, 234, 255, 0.4),
      0 0 2.5em rgba(174, 234, 255, 0.2);
    display: flex;
    flex-flow: column;
    color: #e6faff;
    padding: 1.5em;
  }

  .overlay_window h3 {
    margin: 0;
    padding: 0.6em 1em;
    font-size: 1.4em;
    background: #1a1a1a;
    border-radius: 0.7rem 0.7rem 0 0;
    color: #f0f0f0;
    text-shadow: 0 0 6px rgba(174, 234, 255, 0.5);
  }

  .overlay_window p {
    margin: 0.7em 0 0 0;
    line-height: 1.5em;
    color: #f5faff;
  }
</style>
`;

(() => {
  const css = `
/* ================================
   Buttons
   ================================ */
button, input[type="button"], input[type="submit"] {
  font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
  font-size: 0.9em;
  font-weight: 500;
  padding: 6px 14px;
  border-radius: 4px;
  border: 1px solid #3b4752;
  background: #22282D;
  color: #dfe7eb;
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
  cursor: pointer;
  transition: all 0.2s ease;
  -webkit-appearance: none;
  appearance: none;
}

button:hover, input[type="button"]:hover, input[type="submit"]:hover {
  background: #2e3a46;
  box-shadow: 0 3px 6px rgba(0,0,0,0.5);
}

button:active, input[type="button"]:active, input[type="submit"]:active {
  background: #1a2228;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.6);
}

button:disabled, input[type="button"]:disabled, input[type="submit"]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ================================
   The dropdowns
   ================================ */
select {
  font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
  font-size: 0.9em;
  font-weight: 500;
  padding: 5px 12px;
  border-radius: 4px;
  border: 1px solid #3b4752;
  background: #232b32;
  color: #e1e8ed;
  box-shadow: 0 1px 3px rgba(0,0,0,0.4);
  cursor: pointer;
  appearance: none;
  transition: all 0.2s ease;
}

select option {
  color: #e1e8ed;
  background: #2f3a42;
}

select:hover { background: #35414b; }
select:active { background: #1b232a; }
select:disabled { opacity: 0.5; cursor: not-allowed; }

/* ================================
   Scrollbars
   ================================ */
::-webkit-scrollbar {
  width: 10px;
  height: 12px;
}

::-webkit-scrollbar-track {
  background: #22282D;
}

::-webkit-scrollbar-thumb {
  background-color: #4a5663;
  border: 2px solid #22282D;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background-color: #5c6b7c;
}

/* ================================
   Radio buttons
   ================================ */
input[type="radio"] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  border: 2px solid #2c3136;
  border-radius: 50%;
  outline: none;
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease;
  background: rgba(255,255,255,0.02);
}

input[type="radio"]::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: #2c3136;
  transform: translate(-50%, -50%) scale(0);
  transition: all 0.2s ease;
}

input[type="radio"]:checked::before {
  width: 8px;
  height: 8px;
  transform: translate(-50%, -50%) scale(1);
}

input[type="radio"]:hover { filter: brightness(1.15); }

/* ================================
   Tables
   ================================ */
table {
  width: 90%;
  max-width: 700px;
  margin: 15px auto;
  border-collapse: collapse;
  font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
  font-size: 0.85em;
  color: #dfe7eb;
  background: #22282D;
  border: 1px solid #3b4752;
  border-radius: 4px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
}

th, td {
  padding: 4px 8px;
  text-align: left;
  color: #dfe7eb !important;
  background: #232b32;
  border-bottom: 1px solid #3b4752;
  transition: background 0.25s ease, color 0.25s ease;
  font-weight: normal;
}

thead th,
thead td,
tr:first-child th,
tr:first-child td {
  background: #2f3a42;
  font-weight: 600;
  color: #dfe7eb;
}

tbody tr:nth-child(even) td {
  background: #1f272e;
}

tr:last-child td {
  border-bottom: none;
}

tbody tr:hover td {
  background: #35414b !important;
  color: #ffffff !important;
}

thead tr:hover th,
thead tr:hover td,
tr:first-child:hover th,
tr:first-child:hover td {
  background: #4a5a66 !important;
  color: #ffffff !important;
}


`;

  const id = 'theme';
  if (!document.getElementById(id)) {
    const style = document.createElement('style');
    style.id = id;
    style.textContent = css;
    document.head.appendChild(style);
  }
})();


// Opening screen.

document.getElementById("inner_window_1").children[1].innerHTML = `<div style="text-align: center; margin-top: 0;"><img src="https://i.imgur.com/vv0KkHH.png" alt="Image" style="width: 55%;"></div><p>“What's wrong with some people?”<br><br>This is a question you find yourself asking over and over again. Some of the politicians you meet in Capitol Hill are the most corrupt, nasty, disgusting people you'll ever meet. Few people have wanted to destroy the deep state, even less have tried, but nobody has ever succeeded.<br><br>The wanton abortion loving, sinful marriage loving, America-hating, wealthy, elitist, deep state.<br><br>6 years ago, the Tea Party was swept into power with promises to end the deep state. Most of them became apart of the deep state. But not you. it's time a President fought for the people. We will not stop until we take our country back. No surrender.`;
document.getElementById("inner_window_1").children[0].innerHTML="<h2><i style=\"color:#2e2e2e;\">Tough as Texas</i></h2></i>"

let child = document.getElementById("inner_window_1").children[0];
child.innerHTML = "<h2><i style='color:#2e2e2e;'>He’s Tough as Texas</i></h2>";

// CSS
child.style.textAlign = "center"; // horizontal centering
child.style.marginTop = "0";      // stick to top

// Forces the background to be centered
function appendStyle() {
    if (!document.querySelector('meta[name="viewport"]')) {
        const metaTag = document.createElement('meta');
        metaTag.name = "viewport";
        metaTag.content = "width=device-width, initial-scale=1";
        document.head.appendChild(metaTag);
    }

    if (!document.querySelector('#radio-option-style')) {
        const style = document.createElement('style');
        style.id = 'radio-option-style';
        style.textContent = `
          body {
               background-image: url(https://wallup.net/wp-content/uploads/2019/10/349189-usa-skyscrapers-rivers-new-york-city-night-cities.jpg);
               background-position: center;
               background-size: cover;
          }
        `;
        document.head.appendChild(style);
    }
}

appendStyle();

// Achievements, def gonna add more in the future

campaignTrail_temp.achievements = {
    "New York Values" : {
        "image" : "https://i.imgur.com/ftvkH05.png",
        "description" : "Lose the nomination to Donald Trump.", 
        "cannotBeCheated" : true
 },
    "New American Century" : {
        "image" : "https://i.imgur.com/VPIUlOL.png",
        "description" : "Lose the nomination to Marco Rubio.", 
        "cannotBeCheated" : true
    },
    "Tough as Texas" : {
        "image" : "https://i.imgur.com/3f2CMqk.png",
        "description" : "As Ted Cruz, win the election.", 
        "cannotBeCheated" : true
     },
    "Darker Vision" : {
        "image" : "https://i.imgur.com/1MWng8O.png",
        "description" : "Ally with Trump and win the election.", 
        "cannotBeCheated" : true
 },
       "Decisive Victory" : {
        "image" : "https://i.imgur.com/ouKrLom.png",
        "description" : "Win the nomination without having to contest the convention.", 
        "cannotBeCheated" : true
 },
   "Valid Crashout" : { 
        "image" : "https://i.imgur.com/lVkzf1r.png",
        "description" : "Lash out at Hillary at the debate, and still win.", 
        "cannotBeCheated" : true
  },
   "For Shame" : { 
        "image" : "https://i.imgur.com/tacYbm8.png",
        "description" : "Lose the election on Cakewalk difficulty.", 
        "cannotBeCheated" : true
  },
"A Real Conservative" : {
        "image" : "https://i.imgur.com/M3GaSZP.png",
        "description" : "Push for a national abortion ban and the restriction of same-sex marriage.", 
        "cannotBeCheated" : true
  },
"History Arrives All The Same" : {
        "image" : "https://i.imgur.com/vdBFKe1.png",
        "description" : "Win Wisconsin, Michigan, and Pennsylvania.", // All difficulties Allowed
        "cannotBeCheated" : true
  },
"Texas Toast" : {
        "image" : "https://i.imgur.com/DSRxfjx.png",
        "description" : "Despite your roots, lose your home state.", 
        "cannotBeCheated" : true
  },
"Expanding The Map" : {
        "image" : "https://i.imgur.com/Cnw14a8.png",
        "description" : "Win the state of New Jersey.", // All difficulties allowed
        "cannotBeCheated" : true
  },
"Soul Sold" : {
        "image" : "https://i.imgur.com/e9lBDRH.png",
        "description" : "Sacrifice everything for success.",
        "cannotBeCheated" : true
  },
 "''Fren'' For The End Of The World" : {
        "image" : "https://i.imgur.com/nl3M6gS.png",
        "description" : "Lose to the devil after exposing her tricks.", // you need to cheat to get this one
  },            
"Karmic Retribution" : {
        "image" : "https://i.imgur.com/iUvWk3I.png",
        "description" : "Teach her what justice looks like.", 
        "cannotBeCheated" : true
  },
}


campaignTrail_temp.modBoxTheme = {
     "header_color": "#0c0c0d",
     "header_image_url": "https://i.imgur.com/FWN8Ld1.png",
     "header_text_color": "#ffffff",
     "description_text_color": "#e8eaed",
     "description_background_color": "#252626",
     "main_color": "#12141a",
     "secondary_color": "#242424",
     "ui_text_color": "#FFFFFF"
}

HistHexcolour=["#8E3B3B","#3A5DAE","#E3B807","#168C40",];
        HistName=[" Ted Cruz"," Hillary R. Clinton"," Gary Johnson"," Jill Stein"];
        HistEV=[287,243,0,0];
        HistPV=["66,093,395","65,818,277","1,582,940","1,187,205"];
        HistPVP=["48.6%","48.4%","1.2%","0.9%"];

RecReading=true
campaignTrail_temp.global_parameter_json = [
    {
        "model": "campaign_trail.global_parameter",
        "pk": 1,
        "fields": {
            "vote_variable": 1.125,
            "max_swing": 0.12,
            "start_point": 0.94,
            "candidate_issue_weight": 10,
            "running_mate_issue_weight": 3,
            "issue_stance_1_max": -0.71,
            "issue_stance_2_max": -0.3,
            "issue_stance_3_max": -0.125,
            "issue_stance_4_max": 0.125,
            "issue_stance_5_max": 0.3,
            "issue_stance_6_max": 0.71,
            "global_variance": 0.01,
            "state_variance": 0.005,
            "question_count": 27,
            "default_map_color_hex": "#C9C9C9",
            "no_state_map_color_hex": "#999999"
        }
    }
]

campaignTrail_temp.election_json = [
    {
        "model": "campaign_trail.election",
        "pk": 20,
        "fields": {
            "year": 2016,
            "summary": "After the last few years of Democratic incompetence, the nation looks headed in a new direction. Several Republicans have lined up to correct the errors Obama has made over the past eight years, including Jeb Bush, the establishment favorite backed by megadonors; Marco Rubio, a moderate with Hispanic appeal; and Donald Trump, the wealthy New York billionaire, easily the most bombastic in the field.<br><br>So, on paper, you’d think a newcomer from Texas, hated by the establishment, would get crushed. Elected in the Tea Party wave of 2012, Ted Cruz, the junior senator from Texas, is eager to prove himself on the national stage. Being a devout ideologue, on just about everything, from guns to abortion, has earned him the ire of almost all of Congress and made him equally popular among the base. It’s ground zero for a new conservative explosion.",
            "image_url": "https://i.imgur.com/eQaGw7M.jpeg",
            "winning_electoral_vote_number": 270,
            "advisor_url": "https://i.imgur.com/kS0hzYE.png", 
            "site_description": "Some of the politicians you meet in Capitol Hill are the most corrupt, nasty, disgusting people you'll ever meet. Few people have wanted to destroy the deep state, even less have tried, but nobody has ever succeeded.<br><br>The wanton abortion loving, sinful marriage loving, America-hating, wealthy, elitist, deep state.<br><br>6 years ago, the Tea Party was swept into power with promises to end the deep state. Most of them became apart of the deep state. But not you. it's time a President fought for the people. We will not stop until we take our country back. No surrender. Senator, are you ready?",
            "recommended_reading": `<div id=\"tab-select\"> <p class=\"ftab-active\" id=\"start\">Development</p> <p class=\"ftab\">Info</p> <p class=\"ftab\">Next Mod</p> <p class=\"ftab\">Credits</p> <p class=\"ftab\">Patch Notes</p> </div><div style=\"text-align: left;margin: auto 5em;\"> <span id=\"rpage0\" style=\"display: inline-block;\"> <h2>Tough as Texas</h2> <h3>by TheMcCain</h3><p>Thanks for playing Tough as Texas! This is my second mod, after 2000 ''Redux''. It took a long time, longer then I intended, but I was just glad I was able to get this out before the end of 2025, especially since I started development all the way in mid-August. I created this as a (somewhat) realistic look if Ted Cruz won the 2016 Republican primaries. Of course I took many creative liberties with it, but I stil think it turned out good, much better then what I initially expected. <br><br> I know the margins are a little wonky in some states, so I'll probably modify them in the future. I'll be pushing out updates to this mod regularly, probably bug fixes but also some feature updates. <br><br>    Unfortunately, the images are still Imgur links, because I had already created most of the images by the time Kid Starver banned it. I do hope to port the images over to Filegarden or something sooner or later, but this mod was already taking a long time to make and I didn't want to extend development even further. Sorry UK players. <br><br> I also would've loved to add this mod to The Community Trail, but the Community Trail is basically a completely different game, and it uses a different engine from what NCT and CTS use. Jet had a TCT to OSEG converter, but that stopped working a while ago if I'm correct. <br><br>  I'd like to give a special thanks to theanswerisme for helping write this mod, to littleamericanman for making the banner, and the TCT community as a whole. Hope you had fun playing this mod, I know I did making it.</p></span> <span id=\"rpage1\" style=\"display: inline-block;\"><h2>Info</h2><p><a href=\"https://imgur.com/a/5QLXGRh\" target=\"_blank\" rel=\"noopener noreferrer\">Canon Results</a></p><h4>The Primaries</h4><a href=\"https://en.wikipedia.org/wiki/Ted_Cruz_2016_presidential_campaign\" target=\"_blank\" rel=\"noopener noreferrer\">Ted Cruz 2016 Presidential Campaign</a><br><a href=\"https://www.cbsnews.com/news/donald-trump-gop-convention-2016-how-he-got-here/\" target=\"_blank\" rel=\"noopener noreferrer\">Trump Primary Victory</a><br><a href=\"https://youtu.be/Un3OhYs-tCE?si=jSnYoZSFnWaUH4PX\" target=\"_blank\" rel=\"noopener noreferrer\">Full CBS News South Carolina Republican Debate</a><h4>2016 Presidential Election</h4><a href=\"https://www.brookings.edu/articles/why-hillary-clinton-lost\" target=\"_blank\" rel=\"noopener noreferrer\">Hillary Clinton: Good President, Bad Candidate (this article kinda glazes her ngl but it's still good)</a><br><a href=\"https://www.politico.com/story/2016/11/election-results-2016-clinton-trump-231070\" target=\"_blank\" rel=\"noopener noreferrer\">Donald Trump: Greatest Upset in History?</a><br><h4>Further Helpful Links</h4><a href=\"http://youtube.com/watch?v=PCHJVE9trSM\" target=\"_blank\" rel=\"noopener noreferrer\">Hillary Clinton's “Deplorable” blunder</a><br><a href=\"https://www.youtube.com/watch?v=vgHNFXJgRw0\" target=\"_blank\" rel=\"noopener noreferrer\">Ted Cruz/Carly Fiorina Interview - April 29th, 2016</a><br><a href=\"https://en.wikipedia.org/wiki/2016_Republican_Party_presidential_primaries\" target=\"_blank\" rel=\"noopener noreferrer\">2016 - General Republican Primary Info</a><h4>Books by the Candidates</h4>\rTed Cruz - <a href=\"\&quot;https://www.amazon.com/Time-Truth-Reigniting-Promise-America/dp/0062365614/ref=sr_1_3?crid=1VZF488OH1HLQ&amp;dib=eyJ2IjoiMSJ9.PXdNJgVLtC2EWYOQ1cgk-T9iVdYll0txji4UQaT2zaRUQ4PTl5dThJXV2uVSmoXHYZQD7wpi9OHHmszMrlVzvCRGoaoEMinglMhaY40w1zD05Zwr9toN0ET6HfgNNcn7k1DOJ6LhTWejKAvyl_uXZzMuVKDBtu7ih5Bcs2vL54-VEFPkj_hMPQO_BnyRZg6yaJwWygiPBV5xfKFmdrwuvSRv0W8MXTJZlKDOEesRzGw.bjUlwdmUjTNv1NStBu9Z0evWkkBa02E2SGJl9M1aRu8&amp;dib_tag=se&amp;keywords=A+Time+for+Truth&amp;qid=1760817437&amp;sprefix=a+time+for+truth%2Caps%2C75&amp;sr=8-3\&quot;\" target=\"\&quot;_blank\&quot;\">A Time For Truth</a><br>        \rTed Cruz - <a href=\"\&quot;https://www.amazon.com/Justice-Corrupted-Weaponized-Legal-System/dp/1684513618/ref=pd_bxgy_d_sccl_1/132-5840850-8325653?pd_rd_w=kDpCL&amp;content-id=amzn1.sym.dcf559c6-d374-405e-a13e-133e852d81e1&amp;pf_rd_p=dcf559c6-d374-405e-a13e-133e852d81e1&amp;pf_rd_r=A4Q15XGG9EBPVE2JQ46A&amp;pd_rd_wg=khiwZ&amp;pd_rd_r=650d724a-e277-446e-b629-52e8fc4ead83&amp;pd_rd_i=1684513618&amp;psc=1&quot;\" target=\"\&quot;_blank\&quot;\">Justice Corrupted</a><br>\rHillary Clinton - <a href=\"\&quot;http://www.amazon.com/exec/obidos/ASIN/1476751471/amhius20-20\&quot;\" target=\"\&quot;_blank\&quot;\">Hard Choices</a><br>\rHillary Clinton - <a href=\"\&quot;http://www.amazon.com/exec/obidos/ASIN/0743222253/amhius20-20\&quot;\" target=\"\&quot;_blank\&quot;\">Living History</a><p></p></span> <span id=\"rpage2\" style=\"display: inline-block;\"><h2>Next Mod</h2><p>Right now I'm working on a Killary incumbency simulator mod. <br><br> Basically, if you haven't played <b>W</b>, in that mod Hillary Clinton challenges George Bush in 2004, but with John McCain as her running mate. In the mod she runs a very centrist campaign, and there's multiple ways Bush can attack it. I think it'd be cool to make a mod about what would happen if that really happened. It's going to be alot darker and even more biased then Tough as Texas, and I think it'll be called Eyes Wide Open. The mod your playing right now was cynical but atleast somewhat grounded in reality, this one won't be. <br><br> It includes multiple opponents, so it's probably going to take a while to develop, and I'll probably end up making a couple of smaller mods in between. Stay tuned though! <br><br> This mockup was made by houseyhouse, huge thanks to him!<br><br><img src=\"https://i.imgur.com/lP4cBNe.png\" style=\"display: block; margin: 0 auto; max-height:430px;\"><br><br><img src=\"https://i.imgur.com/udfDOMe.png\" style=\"display: block; margin: 0 auto; max-height:430px;\"></p></span>                     <span id=\"rpage3\" style=\"display: inline-block;\"><h2>Credits</h2><p>I'd also like to say for the record that this mod is a work of fiction and is satire intended for entertainment/commentary, and no ill will goes to any of the individuals in this mod. Some things are exaggerated or altered for story purposes. That's all.</p><span style=\"color: white;\"><li>TheMcCain - lead coder and writer </li><li>theanswerisme - Writing help/advice </li><li>littleamericanman_85501 - Banner</li><li>W. Team - Variable Headquarters</li><li>Thatchmaster - Music player</li><li>Sundance - Further reading tabs (ALOT styling)</li><li>2021 Germany - Tooltips (although it's been modified a lot from what it was previously)</li><li>2016ALOT - Ads (and alot of other styling too)</li><li>And many, many, other mods that I can't remember.</li><hr><p>Huge thanks to everyone who playtested. This mod could have never been as good without you. Those who I forgot to mention, your contributions are not forgotten either.<br><br>As I wrap this further reading up, I'd just like to say again thanks for playing. I hope you enjoyed. <br><br>For now, this is me signing off.</p> </span> </span>     <span id=\"rpage4\" style=\"display: inline-block;\"><h2>Updates</h2><span style=\"color: white;\"><p><b>Tough as Texas v1.1 - November 17th, 2025 - </b><i> <br>''First Update!''</i> </p><li>2 new achievements - ''For Shame'' & ''Fren'' For The End Of The World''.</li> <li>Added ''Patch notes'' tab</li><li>Fixed a bunch of impossible achievements</li><li>Patched out some bugs on the Rubio side</li><li>Minor description/text changes</li><li>Thanks to SamTheGreatestMan for helping with some achievements</li></span></span>      </div>      `,
            "has_visits": 0,
            "no_electoral_majority_image": "https://www.jetsimon.com/public/static/images/2012-no-majority.jpg",
            "creator": "themccain",
            "display_year": "2016"
        }
    }
]

campaignTrail_temp.candidate_json = [
    {
        "model": "campaign_trail.candidate",
        "pk": 200,
        "fields": {
            "first_name": "Ted",
            "last_name": "Cruz",
            "election": 20,
            "party": "Republican Party",
            "state": "Senator from Texas",
            "priority": 1,
            "description": "Becoming a Senator from Texas just around 3 years ago, Ted Cruz has quickly become one of the most controversial members of the Senate. Sent to Capitol Hill in 2012, he's the fighter the Tea Party has been looking for. A staunch conservative and originalist, he's become hated by even many in his own party.<br><br>It all came to a boiling point in October 2013, when Republicans, led by Cruz, refused to pass the next appropriation bill unless Obamacare was defunded. The Democrats refused to back down, and the result was nearly a month of chaos and government shutdown.<br><br>Still disliked by most of Congress and enormously popular amongst conservatives, the young Senator has announced his campaign for President. To win, he must win the primary, unite the party, and still focus on the most important task of defeating Clinton.",
            "color_hex": "#8E3B3B",
            "secondary_color_hex": "#D17A7A",
            "is_active": 1,
            "image_url": "https://i.imgur.com/yqL9NWD.jpeg",
            "electoral_victory_message": "<h3>Congratulations! You have won the 2016 election.</h3><p>In spite of a hard-fought challenge from Hillary Clinton, you have shocked the world with your election victory.</p><p>On the political front, you have the bully pulpit in your favor, but support in Congress in uncertain. Will you govern as a more traditional conservative, or will you make a break from orthodoxy?</p>",
            "electoral_loss_message": "<h3>Sorry! You have lost the 2016 election.</h3><p>Many of your supporters are despondent that you have faltered to the likes of Hillary Clinton. Republicans in general believe this was a very winnable election, and are enraged that you came in to blow it. Luckily, there are any number of ways for you to take advantage of your newfound exposure. One rumor even has you founding a television station to profit from the aggrieved sensibilities of your followers. The future is in your hands.</p>",
            "no_electoral_majority_message": "<h3>Wow! You have pulled out 2016 election.</h3><p>No candidate secured a majority in the Electoral College. However, the Republicans won a majority in Congress and will elevate you to the Presidency. Time will tell how things go in that regard. Any mutual affection between you and Congress is predicted to be short-lived, but you've pulled off a number of surprises to get this far.</p>",
            "description_as_running_mate": "'",
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 201,
        "fields": {
            "first_name": "Hillary R.",
            "last_name": "Clinton",
            "election": 20,
            "party": "Democrat",
            "state": "New York",
            "priority": 2,
            "description": "no description",
            "color_hex": "#3A5DAE",
            "secondary_color_hex": "#6F9EEB",
            "is_active": 0,
            "image_url": "https://i.imgur.com/kg7ymVb.jpeg",
            "electoral_victory_message": "<h3>Congratulations! You have won the 2016 election.</h3><p>In spite of a hard-fought challenge from Donald Trump, you have become the first woman elected to serve as President.</p><p>On the political front, it is unclear how much of your agenda you will be able to push forward with the current Congress. Hopefully your victory has helped Democrats further down the ballot. Start packing and prepare to move back into the White House!</p>",
            "electoral_loss_message": "<h3>Sorry! You have lost the 2016 election.</h3><p>Many of your supporters are despondent that you have faltered to the likes of Donald Trump. Many in the left wing of the party are furious that you pushed their candidate aside, only to lose. Time will tell how Trump operates as President. As for you, a long and sometimes ambiguous political career seems to be coming to its end.</p>",
            "no_electoral_majority_message": "<h3>Sorry! You have lost the 2016 election.</h3><p>No candidate secured a majority in the Electoral College. However, the Republicans won a majority in Congress and will elevate Trump to the Presidency. Time will tell how things go in that regard. As for you, a long and sometimes ambiguous political career seems to be coming to its end.</p>",
            "description_as_running_mate": "'",
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 202,
        "fields": {
            "first_name": "Gary",
            "last_name": "Johnson",
            "election": 20,
            "party": "Libertarian",
            "state": "New Mexico",
            "priority": 3,
            "description": "'",
            "color_hex": "#E3B807",
            "secondary_color_hex": "#E3C380",
            "is_active": 0,
            "image_url": "'",
            "electoral_victory_message": "'",
            "electoral_loss_message": "'",
            "no_electoral_majority_message": "'",
            "description_as_running_mate": "'",
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 203,
        "fields": {
            "first_name": "Jill",
            "last_name": "Stein",
            "election": 20,
            "party": "Green",
            "state": "Massachusetts",
            "priority": 4,
            "description": "'",
            "color_hex": "#168C40",
            "secondary_color_hex": "#6DAE8C",
            "is_active": 0,
            "image_url": "'",
            "electoral_victory_message": "'",
            "electoral_loss_message": "'",
            "no_electoral_majority_message": "'",
            "description_as_running_mate": "'",
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 50000,
        "fields": {
            "first_name": "Carly",
            "last_name": "Fiorina",
            "election": 20,
            "party": "Republican Party",
            "state": "Former CEO of Hewlett-Packard",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#981619",
            "secondary_color_hex": "#C16E65",
            "is_active": 0,
            "image_url": "https://i.imgur.com/BOfMYNF.jpeg",
            "electoral_victory_message": "Win",
            "electoral_loss_message": "Loss",
            "no_electoral_majority_message": "No majority",
            "description_as_running_mate": "Carly Fiorina would certainly be an unorthodox choice. As one of your former primary opponents and the ex-CEO of corporate giant Hewlett-Packard, she has little political experience, her only foray into politics was a failed 2010 Senate run in California.<br><br>Still, despite being unconventional, Fiorina could offer unique advantages. She might help reclaim portions of the female vote from Hillary Clinton and could serve as a bridge between moderates and conservatives heading into the general election. She also performed well in the primary debates.<br><br>On the other hand, Fiorina’s record at HP is mired in controversy. Thousands of employees were laid off during her tenure, and in 2005 she was forced out by shareholders amid the company’s poor performance. Her corporate past would inevitably become a liability for the ticket.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 50002,
        "fields": {
            "first_name": "Marco",
            "last_name": "Rubio",
            "election": 20,
            "party": "Republican Party",
            "state": "Senator from Florida",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#981619",
            "secondary_color_hex": "#C16E65",
            "is_active": 0,
            "image_url": "https://i.imgur.com/EBcp4Gx.jpeg",
            "electoral_victory_message": "Win",
            "electoral_loss_message": "'",
            "no_electoral_majority_message": "'",
            "description_as_running_mate": "<p>Marco Rubio was one of your main opponents in the primary, ultimately finishing third. Currently serving as a U.S. Senator from Florida, Rubio could be a major asset in that state. He should also help solidify your support among Cuban-Americans, with both of you sharing Cuban heritage. Florida’s 29 electoral votes will prove decisive in this election, and Rubio’s popularity there could be crucial to securing victory on Election Day. He also has bona fides among independent voters and would bring a more moderate voice to the ticket.</p>Conversely, the two of you don’t exactly share warm relations, having waged hard-hitting campaigns against each other during the primary. Many of your supporters may be disappointed if you choose him as your running mate. Still, if you’re looking for a safer, more moderate pick that will provide ideological balance, he’s an option. ",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 50001,
        "fields": {
            "first_name": "Scott",
            "last_name": "Walker",
            "election": 20,
            "party": "Republican Party",
            "state": "Governor of Wisconsin",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#981619",
            "secondary_color_hex": "#C16E65",
            "is_active": 0,
            "image_url": "https://i.imgur.com/4AmhUDX.png",
            "electoral_victory_message": "Win",
            "electoral_loss_message": "'",
            "no_electoral_majority_message": "'",
            "description_as_running_mate": "<p>Scott Walker is the current Governor of Wisconsin. Elected in 2010, he pushed a number of conservative policies during his time in office, most notably the Wisconsin Budget Repair Bill, which stripped most public sector workers of collective bargaining rights. The bill sparked massive backlash and quickly led to a recall effort. Walker survived the recall by a wide margin and became highly popular in conservative circles.<br><br>Walker ran for the nomination this cycle but dropped out early after a series of poor performances. He would certainly help you in the Upper Midwest, particularly in his home state of Wisconsin, which is looking close this year. However, if you're trying to expand your coalition, Walker would likely make that task more difficult.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate", 
        "pk": 50005,
        "fields": {
            "first_name": "John",
            "last_name": "Kasich",
            "election": 20,
            "party": "Republican Party",
            "state": "Governor of Ohio",
            "priority": 1,
            "description": "John Kasich is the current Governor of Ohio and was a longtime Congressman from the state. Being one of the most moderate Republicans who were in the running this year, he has very high approval ratings in his home state of Ohio, and could definitely help the ticket in that state. Additionally, Kasich has years of experience as Governor and decades in Congress, which could help soothe fears about your experience. Kasich also is by far the most moderate option you have, and could definitely help bring back some voters</p>",
            "color_hex": "#B22222",
            "secondary_color_hex": "#E57373",
            "is_active": 0,
            "image_url": "https://i.postimg.cc/25QjGJ1h/EBcp4Gx.jpg",
            "electoral_victory_message": "<h3>Congratulations! You have won the 2016 election.</h3><p>In spite of a hard-fought challenge from Hillary Clinton, you have shocked the world with your election victory.</p><p>On the political front, you have the bully pulpit in your favor, but support in Congress in uncertain. Will you govern as a more traditional conservative, or will you make a break from orthodoxy?</p>",
            "electoral_loss_message": "<h3>Sorry! You have lost the 2016 election.</h3><p>Many of your supporters are despondent that you have faltered to the likes of Hillary Clinton. Republicans in general believe this was a very winnable election, and are enraged that you came in to blow it. Luckily, there are any number of ways for you to take advantage of your newfound exposure. One rumor even has you founding a television station to profit from the aggrieved sensibilities of your followers. The future is in your hands.</p>",
            "no_electoral_majority_message": "<h3>Wow! You have pulled out 2016 election.</h3><p>No candidate secured a majority in the Electoral College. However, the Republicans won a majority in Congress and will elevate you to the Presidency. Time will tell how things go in that regard. Any mutual affection between you and Congress is predicted to be short-lived, but you've pulled off a number of surprises to get this far.</p>",
            "description_as_running_mate": "<p>John Kasich is the current Governor of Ohio. Being one of the most moderate Republicans who were in the running this year, he has very high approval ratings in his home state of Ohio, and could definitely help the ticket in that state. Additionally, Kasich has years of experience as Governor and decades in Congress, which could help soothe fears about your experience. Kasich also is by far the most moderate option you have, and could definitely help bring back some voters who are alienated by how conservative you are.<br><br>Of course though, many of your hardcore supporters will be disappointed with Kasich's presence on the ticket, and he doesn't offer anything to the Trump wing, being one of his most prominent critics in the primaries, but overall, Kasich would be a good choice for your running mate.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    }
]

campaignTrail_temp.running_mate_json = [
    {
        "model": "campaign_trail.running_mate",
        "pk": 118222,
        "fields": {
            "candidate": 200,
            "running_mate": 50000
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 94412,
        "fields": {
            "candidate": 200,
            "running_mate": 50001
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 156797,
        "fields": {
            "candidate": 200,
            "running_mate": 50002
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 129103,
        "fields": {
            "candidate": 0,
            "running_mate": 50005

        }
    }
]

credits = function() {
    c = ["This mod was made by theMcCain and theanswerisme, with theMcCain being the lead coder and lead writer and theanswerisme helping with writing.\n", "Thanks to littleamericanman_85501 for making the banner!\n", "Thanks to American Carnage for the music player, The W. Team for variable headquarters (although it's been modified heavily), 2016: A Lifetime Of This for the banner system and alot of other styling, and many other mods that this mod borrows code or ideas from. You can find a full credits in the Further Reading.\n", "Thanks to everyone who playtested.\n",  "And thanks for playing! Hope you have fun."]
    text = "CREDITS:\n\n"
    for (i in c) {
        text += c[i] + "\n"
    }
    alert(text)
  }

campaignTrail_temp.credits = "<button onclick='credits()'><u>TheMcCain &</button></u>";

campaignTrail_temp.opponents_default_json = [
    {
        "election": 20,
        "candidates": [
            200,
            201,
            202,
            203
        ]
    }
]

campaignTrail_temp.opponents_weighted_json = [
    {
        "election": 20,
        "candidates": [
            200,
            201,
            202,
            203
        ]
    }
]

campaignTrail_temp.temp_election_list = [
    {
        "id": 20,
        "year": 2016,
        "is_premium": 0,
        "display_year": "2016 - Tough As Texas"
    }
]

jet_data = {
    "headerColor": "#fa7d07",
    "windowColor": "#8640a3",
    "containerColor": "#b15596",
    "innerWindowColor": "#8640a3",
    "bannerImageUrl": "https://i.imgur.com/3iXJcrL.png",
    "backgroundImageUrl": "https://wallpaper-house.com/data/out/7/wallpaper2you_175134.jpg",
    "endingTextColor": "#000000",
    "customQuote": "Ted Cruz",
    "gameTitle": "New Campaign Trail"
}

const gameStart = document.getElementById('game_start');
    const gameWindow = document.getElementById('game_window');

    if (gameStart) {
        gameStart.innerHTML = '<strong>This is war.</strong>';
        const clearHeight = () => { if (gameWindow) gameWindow.style.removeProperty('height'); };
        if (window.jQuery) $('#game_start').on('click', clearHeight);
        else gameStart.addEventListener('click', clearHeight);
    }

corrr = `
  <h2 style="
    font-family: Tahoma, Geneva, sans-serif;
    font-size: 36px;
    color: white;
    padding: 5px 10px;
    background: linear-gradient(90deg, #1e242a, #2a353f);
    border-radius: 0px;
    box-shadow: inset 0 0 10px rgba(0,255,255,0.1), 0 0 8px rgba(0,255,255,0.05);
  ">
   The Cruz Trail
  </h2>
`;




nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#292826";

nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#212120";

document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;

$("#game_window")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_window;

$(".container")[0].style.backgroundColor = "#22282D";

document.getElementById("header").src = "https://i.imgur.com/5cN59fs.gif";

document.body.background = "https://images.wallpaperscraft.com/image/single/night_city_city_lights_metropolis_126569_2560x1440.jpg";

document.head.innerHTML += "<style>#results_container {color:#ffffff;} </style>";

// This is pretty much all the custom styles for the mod. Many of them were taken from A Lifetime Of This and adapted to work here.

let style = document.createElement('style');
style.type = 'text/css';
style.id = 'dynamic-style';

style.innerHTML = `
  .campaign_trail_start_emphasis {
    background: linear-gradient(135deg, #1e242a, #2a353f);
  }

a {
  color: #007A7A;
  transition: color 0.3s ease;
}

a:hover {
  color: #005E5E;
}

.inner_window_w_desc {
    background: linear-gradient(135deg, #1B1F23 0%, #22262B 50%, #2C3035 100%) !important;
}

  /* Questions */
  .inner_window_question h3 {
    background: linear-gradient(135deg, #1e242a, #2a353f) !important;
    color: #ffffff !important;
  }

  /* Game Link doesn't work, so just removing it */
  #overall_details_container a {
    display: none;
  }

  /* Header and text colors */
  #final_results_description h3,
  #overall_details_container h3,
  #overall_election_details h4,
  #main_content_area_reading h3.results_tab_header,
  .inner_window_w_desc h3 {
    color: white;
  }

  #main_content_area_reading p,
  #final_results_description p,
  div#site_credits p,
  div#site_credits a,
  p#credits {
    color: white !important;
  }

  #theme_picker,
  .footer h4 {
    display: none;
  }

  #map_footer {
    display: flex;
    justify-content: center;
    margin-top: 1rem !important;
  }

#election_image img {
  border: 2px solid #333333; 
  border-radius: 0;          
}

  blockquote {
    border-left: 4px solid #008080;
    font-style: italic;
    margin: 1em;
    padding: 0 1em;
  }

  /* Benefit checker, achievement, and cheat menu */
  #benefitwindow {
    overflow: auto;
    background-color: #20272D;
    color: #e0e0e0;
    border: 1px solid #444;
    border-radius: 5px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    font-family: Arial, sans-serif;
  }

  #benefitwindowheader,
  #achwindowheader {
    background-color: #1B2228;
    color: #f5f5f5;
    font-size: 17px;
    font-weight: bold;
    padding: 10px 15px;
    border-bottom: 1px solid #444;
  }

  #benefitcontent {
    margin: 5px 10px;
    overflow-x: clip;
    color: #e0e0e0;
  }

  #achwindow {
    top: 5%;
    left: 25%;
    background-color: #20272D;
    border: 1px solid #444;
    border-radius: 5px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  }

  #achcontent {
    overflow: auto;
    overflow-y: scroll;
    max-height: 400px;
    color: #e0e0e0;
  }

  #cheatMenu {
    margin-top: 1em;
    background-color: #22282D;
    color: #000000;
    border: 1px solid #666;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: default;
    transition: background-color 0.2s ease;
  }

  #cheatMenu:hover {
    background-color: #2a3036;
  }

  #showBenefitCheckButton {
    margin-top: 1em;
  }

  /* Scrollbars */
  #benefitwindow::-webkit-scrollbar,
  #achcontent::-webkit-scrollbar {
    width: 10px;
  }

  #benefitwindow::-webkit-scrollbar-track,
  #achcontent::-webkit-scrollbar-track {
    background: #20272D;
  }

  #benefitwindow::-webkit-scrollbar-thumb,
  #achcontent::-webkit-scrollbar-thumb {
    background-color: #555;
    border-radius: 5px;
    border: 2px solid #20272D;
  }

  #benefitwindow::-webkit-scrollbar-thumb:hover,
  #achcontent::-webkit-scrollbar-thumb:hover {
    background-color: #777;
  }

  /* New game screen */
  #new_game_buttons {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
    padding-bottom: 1rem;
  }

  /* Overlay windows */
  .overlay_window h3 {
    background: linear-gradient(135deg, #2c3e50, #1c2833) !important;
    color: #ffffff !important;
  }
  #state_info h3,
  #state_result h3,
  #overall_result h3 {
    background: linear-gradient(135deg, #2a353f, #1e242a) !important;
    color: #ffffff !important;
  }

  img#candidate_pic,
  img#running_mate_pic {
    border: 2px solid #2a353f;
    border-radius: 4px;
  }

  #menu_container {
    background: linear-gradient(135deg, #1a2025, #2a353f) !important;
  }
  #recommended_reading_box {
    margin: 1rem auto;
     overflow-y: auto;
            }
#difficulty_mult {
    position: relative; 
    top: 20px;         
}

  .overlay_window {
    height: auto;
    background: linear-gradient(135deg, #1a2025, #2a353f, #1e242a);
    color: #e0f7ff;
  }

  #state_result_container,
  #overall_result_container {
    background: linear-gradient(135deg, #e6e6e6, #d4d4d4) !important;
  }

#autoplayMenu label {
color: white;
}

  .visit_text {
    background: #1F262C;
    color: white;
    border-radius: 0.3em;
    width: fit-content;
    margin-inline: auto;
    padding: 0.5rem;
  }

#map_container {
  background: linear-gradient(
    315deg,
    #2f5470 0%,   
    #3e3b52 50%,  
    #453535 100%  
  ) !important;
  background-size: 200% 200%;
}

  .game_header h2 {
    color: #ffffff;
    text-shadow: 0 0 6px rgba(0,255,255,0.3);
  }
`;

document.head.appendChild(style);

//#endcode

// Music Player
// Select the node that will be observed for mutations
const windowsAdvisorTargetNode = document.getElementById("game_window");

// Options for the observer (which mutations to observe)
const windowsAdvisorConfig = { attributes: true, childList: true, subtree: true };

// Callback function to execute when mutations are observed
const callback = (mutationList, observer) => {
    visitWindow = document.getElementsByClassName("overlay_window")[0];

    if(visitWindow == null || visitWindow.classList.contains("done")) {
        return;
    }
    visitWindow.classList.add("done");
    visitWindow.classList.add("window");
    let titleBar = visitWindow.querySelector("h3");
    titleBar.classList.add("title-bar");
    titleBar.classList.add("title-bar-text")
    titleBar.style.paddingLeft = "3px";
};

class Song {
  constructor(title, artist, coverLink, audioLink) {
    this.title = title;
    this.artist = artist;
    this.coverLink = coverLink;
    this.audioLink = audioLink;
  }
  getTitle() {
    return this.title;
  }

  getArtist() {
    return this.artist;
  }

  getCoverLink() {
    return this.coverLink;
  }

  getAudioLink() {
    return this.audioLink;
  }
}

class Playlist {
  constructor() {
    this.songs = [];
    this.currentSongIndex = 0;
  }

  addSong(song) {
    this.songs.push(song);
  }

  getCurrentSong() {
    return this.songs[this.currentSongIndex];
  }

  playNext() {
    this.currentSongIndex = (this.currentSongIndex + 1) % this.songs.length;
  }

  playPrevious() {
    this.currentSongIndex = (this.currentSongIndex - 1 + this.songs.length) % this.songs.length;
  }
}
window.Playlist=Playlist
window.Song=Song

function changePlaylist(newPlaylist) {
  playlist = newPlaylist;
  playlist.currentSongIndex = 0;
  updateUI(playlist);
  const audio = document.getElementById("audio");
  audio.src = playlist.getCurrentSong().audioLink;
  audio.play();
}
window.changePlaylist=changePlaylist

function updateUI(playlist) {
    const currentSong = playlist.getCurrentSong();
    var player = document.getElementById("player");
    player.querySelector("#cover").src = currentSong.getCoverLink();
    player.querySelector("#title").textContent = currentSong.getTitle();
    player.querySelector("#artist").textContent = currentSong.getArtist();
}

window.updateUI=updateUI


function setupMusicPlayer() {
  playlist = new Playlist();

  const song1 = new Song(
    "Born In The U.S.A",
    "Bruce Springsteen",
    "https://i.imgur.com/xTyz859.png",
    "https://audio.jukehost.co.uk/y8UAbY6RebjqpgtxRtOJZxrVPVRB0eND"
  );

  const song2 = new Song(
    "You've Got To Stand For Something",
    "Aaron Tippin",
    "https://i.imgur.com/O7c1hor.png",
    "https://audio.jukehost.co.uk/ZQnMufZGNbmyEQUhR6dLQx8ozFYmmNDD"
  );
  
  const song3 = new Song(
    "God Bless the U.S.A",
    "Lee Greenwood",
    "https://i.imgur.com/elUafEV.png",
    "https://audio.jukehost.co.uk/A7K1Ha1w2kmRXPz8qC3DcNrQWxQTPTRs"
  );

  const song4 = new Song(
    "American Ride",
    "Toby Keith",
    "https://i.imgur.com/8J1LKFA.png",
    "https://audio.jukehost.co.uk/2cvWGDd0rvlDnZWEnw8OKrlk4EQHzOiy"
  );

  const song5 = new Song(
    "As Good As I Once Was",
    "Toby Keith",
    "https://i.imgur.com/F7gd9Mv.jpeg",
    "https://audio.jukehost.co.uk/tCO8u2zmunpUWoSfiLStFLdrFi9VTvf9"
  );

  const song6 = new Song(
    "Rockin' In The Free World",
    "Neil Young",
    "https://i.imgur.com/rsjTJWY.png",
    "https://audio.jukehost.co.uk/EszA1MFZjpHCByR2r4t6zuQOUNqV6Ck5"
  );

  playlist.addSong(song1);
  playlist.addSong(song2);
  playlist.addSong(song3);
  playlist.addSong(song4);
  playlist.addSong(song5);
  playlist.addSong(song6);


  const playerContainer = document.createElement("div");
  playerContainer.id = "player";

  const displayBox = document.createElement("div");
  displayBox.id = "display-box";

  const coverElement = document.createElement("img");
  coverElement.id = "cover";
  displayBox.appendChild(coverElement);

  const infoContainer = document.createElement("div");
  infoContainer.id = "info-container";
  infoContainer.style.backgroundImage = "url('https://i.imgur.com/pQXnzV6.png')";
  infoContainer.style.backgroundSize = "cover";
  infoContainer.style.color = "white";

  const songInfo = document.createElement("div");
  songInfo.id = "song-info";

  const titleElement = document.createElement("h3");
  titleElement.id = "title";
  titleElement.style.fontWeight = 'large';
  songInfo.appendChild(titleElement);

  const artistElement = document.createElement("p");
  artistElement.id = "artist";
  songInfo.appendChild(artistElement);

  infoContainer.appendChild(songInfo);
  displayBox.appendChild(infoContainer);

  playerContainer.appendChild(displayBox);

  const controlsContainer = document.createElement("div");
  controlsContainer.id = "controls-container";

  const controls = document.createElement("div");
  controls.id = "controls";

  const prevButton = document.createElement("img");
  prevButton.id = "prevButton";
  prevButton.src = "https://i.imgur.com/imIqTEA.png";
  prevButton.alt = "Previous";
  controls.appendChild(prevButton);

  const playPauseButton = document.createElement("img");
  playPauseButton.id = "playPauseButton";
  playPauseButton.src = "https://i.imgur.com/oQbfTxw.png";
  playPauseButton.alt = "Play/Pause";
  controls.appendChild(playPauseButton);

  const nextButton = document.createElement("img");
  nextButton.id = "nextButton";
  nextButton.src = "https://i.imgur.com/7TtaN04.png";
  nextButton.alt = "Next";
  controls.appendChild(nextButton);

  controlsContainer.appendChild(controls);

  playPauseButton.addEventListener("click", function () {
    const audio = document.getElementById("audio");
    if (audio.paused) {
      audio.play();
      playPauseButton.src = "https://i.imgur.com/ttdoyfG.png"; // pause icon
    } else {
      audio.pause();
      playPauseButton.src = "https://i.imgur.com/oQbfTxw.png"; // play icon
    }
  });

  nextButton.addEventListener("click", function () {
    playlist.playNext();
    updateUI(playlist);
    const audio = document.getElementById("audio");
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
  });

  prevButton.addEventListener("click", function () {
    playlist.playPrevious();
    updateUI(playlist);
    const audio = document.getElementById("audio");
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
  });

  const progressBarContainer = document.createElement("div");
  progressBarContainer.id = "progress-bar-container";

  const progressBar = document.createElement("input");
  progressBar.type = "range";
  progressBar.id = "progress-bar";
  progressBar.value = "0";
  progressBar.max = "100";

  progressBarContainer.appendChild(progressBar);
  controlsContainer.appendChild(progressBarContainer);
  playerContainer.appendChild(controlsContainer);

  const volumeContainer = document.createElement("div");
  volumeContainer.id = "volume-container";

  const volumeLabel = document.createElement("img");
  volumeLabel.src = "https://i.imgur.com/0BJYsXt.png";
  volumeLabel.alt = "Volume";
  volumeContainer.appendChild(volumeLabel);

  const volumeSliderContainer = document.createElement("div");
  volumeSliderContainer.classList.add("is-vertical");
  volumeSliderContainer.style.marginLeft = "23%";
  volumeSliderContainer.style.height = "126px";

  const volumeSlider = document.createElement("input");
  volumeSlider.type = "range";
  volumeSlider.id = "volumeSlider";
  volumeSlider.min = 0;
  volumeSlider.max = 9;
  volumeSlider.step = 1;
  volumeSlider.value = 9;

  volumeSliderContainer.appendChild(volumeSlider);

  const volumeDisplay = document.createElement("span");
  volumeDisplay.id = "volume-display";
  volumeDisplay.style.fontWeight = 'bold'; 
  volumeDisplay.style.display = 'none';
  volumeDisplay.textContent = "1";

  volumeContainer.appendChild(volumeSliderContainer);
  volumeContainer.appendChild(volumeDisplay);

  playerContainer.appendChild(volumeContainer);

  gameWindow_player.insertAdjacentElement("afterend", playerContainer);

  function updateProgressBar() {
    const audio = document.getElementById("audio");
    const progress = (audio.currentTime / audio.duration) * 100;
    try{progressBar.value = progress}
    catch{}
  }

  progressBar.addEventListener("input", function () {
    const audio = document.getElementById("audio");
    const seekTime = (progressBar.value / 100) * audio.duration;
    audio.currentTime = seekTime;
  });

  const audio = document.createElement("audio");
  audio.id = "audio";
  audio.src = playlist.getCurrentSong().audioLink;
  audio.volume = 9/9;

  audio.addEventListener("timeupdate", updateProgressBar);
  audio.addEventListener("ended", function () {
    playlist.playNext();
    updateUI(playlist);
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
  });

  let currentVolume = 1;

  volumeSlider.addEventListener("input", function () {
    currentVolume = parseInt(volumeSlider.value, 10);
    updateVolumeDisplay();
    updateAudioVolume();
  });

  function updateVolumeDisplay() {
    volumeDisplay.textContent = currentVolume;
  }

   function updateAudioVolume() {
    const audio = document.getElementById("audio");
    audio.volume = currentVolume / 9;
  }

  document.body.appendChild(audio);
  audio.play();

  updateUI(playlist);
}

if (!document.getElementById("musicPlayerStyles")) {
  const style = document.createElement("style");
  style.id = "musicPlayerStyles";
  style.textContent = `
  #player {
      border: 3px solid #C9C9C9;
      display: flex;
      flex-direction: row;
      height:191px;
      background-Image: url("https://i.imgur.com/Ok791w6.png");
    }

    #display-box {
      display: flex;
      align-items: center;
      width: 50%;
    }

    #cover {
      width: 176px;
      height:176px;
    }

    #info-container {
      display: flex;
      flex-direction: row;
      height:178px;
      width:127px;
      margin-top: 3px;
    }

    #song-info {
      width: 100%;
      padding:5px;
    }

    #controls-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 10px;
      width:100%;
      padding-top:15px;
    }

    .is-vertical #volumeSlider {
      width: 16px;
      height: 100%;
      writing-mode: vertical-rl;
      direction: rtl;
    }

    #controls {
      display: flex;
      flex-direction: row;
      justify-content: center;
      width: 80%;
    }

    #progress-bar-container {
      width: 100%;
    }

    #progress-bar {
      width: 80%;
      margin: auto;
      display: flex;
      margin-top: 20px;
    }
  `;
  document.head.appendChild(style);
}

const gameWindow_player = document.getElementById("game_window");
setupMusicPlayer();

$("#game_window")[0].style.background = "linear-gradient(#303841, #1b1f23)";

// Banner advertisements. Also from 2016ALOT

(function() {
    const gameWindow = document.getElementById("game_window");
    if (!gameWindow) return;

    // configuration object
    const CONFIG = {
        bannerHeight: 60,
        fadeTransition: 250,
        preloadCount: 4,
        enablePreloading: true,
        enableLocalStorage: true,
        hoverEffect: true,
        clickCooldown: 150,
        maxCacheSize: 20,
        useRequestIdleCallback: true
    };

    // banner list
const banners = [
    // Ted Cruz (4 total)
    { url: "https://www.p2016.org/blogads/ted%20cruz%20042915%20blogad%20728x90%20punches%20flinch%20fredmiranda.gif", weight: 1 },
    { url: "https://www.p2016.org/blogads/cruz042715p2016c.gif", weight: 1 },
    { url: "https://www.p2016.org/blogads/cruz052915p2016.gif", weight: 1 },
    { url: "https://www.p2016.org/blogads/ted%20cruz%20042815%20blog%20ad%20728x90%20firstduty.gif", weight: 1 },

    // Marco Rubio (2 total)
    { url: "https://www.p2016.org/blogads/rubio4president102915xx13334955871083654536.png", weight: 1 },
    { url: "https://www.p2016.org/blogads/160213_MarcoRubio_Display_728x90.gif", weight: 1 },

    // Trump (3 total)
    { url: "https://www.p2016.org/blogads/trump033016breitbart.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/trump0815newsmax893F9CBF65B5451695FE6D4CE6E30E45%20%281%29.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/nextgen012616crgazetta.jpg", weight: 1 },

    // Jeb Bush (2 total)
    { url: "https://www.p2016.org/blogads/jeb%20bush%20061715%20blogad%20728x90%20team%20jeb%20drudge.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/jeb%20bush%20061715%20blogad%20728x90%20team%20jeb%20drudge.jpg", weight: 1 },

    // Bernie Sanders (2 total)
    { url: "https://www.p2016.org/blogads/fsanders060516fresnobee3870331466086464205.jpeg", weight: 1 },
    { url: "https://www.p2016.org/blogads/fsanders060516fresnobee3870331466086464205.jpeg", weight: 1 },

    // Rand Paul (2 total)
    { url: "https://www.p2016.org/blogads/rand%20paul%20070915%20blogad%20728x90%20stand%20with%204President.gif", weight: 1 },
    { url: "https://www.p2016.org/blogads/rand%20paul%20070915%20blogad%20728x90%20stand%20with%204President.gif", weight: 1 },

    // Chris Christie (2 total)
    { url: "https://www.p2016.org/blogads/chris%20christie%20063015%20blogad%20728x90%20running%20for%20president%204President.gif", weight: 1 },
    { url: "https://www.p2016.org/blogads/chris%20christie%20063015%20blogad%20728x90%20running%20for%20president%204President.gif", weight: 1 },

    // Clinton (4 total)
    { url: "https://www.p2016.org/blogads/clinton030516msn1.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/clinton010316dailymail728x90__9_.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/clinton040916p2016xxlistbuilding-sheswithus-color-hrcwhite-imwithher-amn-html5-728x90.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/clinton040916p2016xxlistbuilding-sheswithus-color-hrcwhite-imwithher-amn-html5-728x90.jpg", weight: 1 },

    // Others / Misc
    { url: "https://www.p2016.org/blogads/scott%20walker%20080715%20blogad%20728x90%20chip%20in%204president.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/NARAL_HRC_IEAd_NHLaborNews_800x100-20151223.jpg", weight: 1 },
    { url: "https://i.imgur.com/0p1Y0mw.png", weight: 1 },
    { url: "https://i.imgur.com/dmnu9p6.png", weight: 1 },
    { url: "https://www.p2016.org/blogads/lb-post1013debate-hwins-728x90-st-1.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/rtrnashuatelegraph012916xxe9d9be71-9dcd-42ed-ab8c-3f007d080bdb.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/walker091615p2016xx3640419123098670429.jpg", weight: 1 },
    { url: "https://www.p2016.org/blogads/bearingdrift020716xx8394401851222088692.gif", weight: 1 },
    { url: "https://www.p2016.org/blogads/comicbookmoviecom013016xx724e818f-a251-4a11-828e-d82eb600712f.jpg", weight: 1 },
    { url: "https://i.imgur.com/OJigFr9.png", weight: 1 }
];


    // caching system
    class BannerCache {
        constructor() {
            this.imageCache = new Map();
            this.loadedUrls = new Set();
            this.storageKey = 'vintageBannerCache_v2';
            this.maxCacheAge = 7 * 24 * 60 * 60 * 1000; // 7 days
            this.cacheAccessOrder = [];

            if (CONFIG.enableLocalStorage) {
                this.loadFromStorage();
            }
        }

        saveToStorage() {
            if (!CONFIG.enableLocalStorage) return;

            try {
                const cacheData = {
                    timestamp: Date.now(),
                    urls: Array.from(this.loadedUrls)
                };
                localStorage.setItem(this.storageKey, JSON.stringify(cacheData));
            } catch (e) {
                // silent fail
            }
        }

        loadFromStorage() {
            try {
                const cached = localStorage.getItem(this.storageKey);
                if (!cached) return;
                
                const data = JSON.parse(cached);
                const age = Date.now() - data.timestamp;

                if (age < this.maxCacheAge) {
                    this.loadedUrls = new Set(data.urls);
                } else {
                    localStorage.removeItem(this.storageKey);
                }
            } catch (e) {
                // silent fail
            }
        }

        preloadImage(url) {
            if (this.imageCache.has(url)) {
                this.updateCacheOrder(url);
                return Promise.resolve(this.imageCache.get(url));
            }

            return new Promise((resolve, reject) => {
                const img = new Image();
                let timeoutId;
                
                const cleanup = () => {
                    clearTimeout(timeoutId);
                    img.onload = img.onerror = null;
                };

                timeoutId = setTimeout(() => {
                    cleanup();
                    reject(new Error(`Timeout: ${url}`));
                }, 8000);

                img.onload = () => {
                    cleanup();
                    this.addToCache(url, img);
                    resolve(img);
                };

                img.onerror = () => {
                    cleanup();
                    reject(new Error(`Failed: ${url}`));
                };

                // set image loading priority to low
                img.fetchPriority = "low";
                img.src = url;
            });
        }

        addToCache(url, img) {
            // LRU cache eviction policy
            if (this.imageCache.size >= CONFIG.maxCacheSize && !this.imageCache.has(url)) {
                const lruUrl = this.cacheAccessOrder.shift();
                this.imageCache.delete(lruUrl);
            }
            
            this.imageCache.set(url, img);
            this.updateCacheOrder(url);
            this.loadedUrls.add(url);
            this.saveToStorage();
        }

        updateCacheOrder(url) {
            // remove url if it exists in the order array
            const index = this.cacheAccessOrder.indexOf(url);
            if (index > -1) {
                this.cacheAccessOrder.splice(index, 1);
            }
            // add to the end (most recently used)
            this.cacheAccessOrder.push(url);
        }

        preloadBatch(urls) {
            if (!CONFIG.enablePreloading) return Promise.resolve();

            if (CONFIG.useRequestIdleCallback && window.requestIdleCallback) {
                return new Promise(resolve => {
                    window.requestIdleCallback(() => {
                        const promises = urls.map(url => 
                            this.preloadImage(url).catch(() => null)
                        );
                        Promise.allSettled(promises).then(resolve);
                    }, { timeout: 2000 });
                });
            } else {
                const promises = urls.map(url => 
                    this.preloadImage(url).catch(() => null)
                );
                return Promise.allSettled(promises);
            }
        }

        getCachedImage(url) {
            const img = this.imageCache.get(url);
            if (img) {
                this.updateCacheOrder(url);
            }
            return img || null;
        }
    }

    // weighted random selection with memoization
    const bannerSelector = (() => {
        let weightSum = null;
        
        const getTotalWeight = () => {
            if (weightSum === null) {
                weightSum = banners.reduce((sum, banner) => sum + banner.weight, 0);
            }
            return weightSum;
        };

        return {
            getRandomBanner(excludeRecent = []) {
                const availableBanners = banners.filter(b => !excludeRecent.includes(b.url));
                
                if (availableBanners.length === 0) {
                    const currentUrl = excludeRecent[excludeRecent.length - 1];
                    return banners.find(b => b.url !== currentUrl) || banners[0];
                }
                
                const totalWeight = availableBanners.reduce((sum, banner) => sum + banner.weight, 0);
                let random = Math.random() * totalWeight;
                
                for (const banner of availableBanners) {
                    random -= banner.weight;
                    if (random <= 0) return banner;
                }
                
                return availableBanners[0];
            },
            
            // precompute weighted selection table
            initializeSelectionTable() {
                getTotalWeight();
            }
        };
    })();

    // banner system
    class ClickableBannerSystem {
        constructor() {
            this.createElements();
            
            this.cache = new BannerCache();
            this.currentBanner = null;
            this.recentBanners = [];
            this.isTransitioning = false;
            this.lastClickTime = 0;
            this.rafId = null;

            this.init();
        }

        init() {
            this.setupEventListeners();
            bannerSelector.initializeSelectionTable();
            
            Promise.resolve()
                .then(() => this.preloadInitialBanners())
                .then(() => this.displayRandomBanner())
                .catch(() => {
                    // fallback if preloading fails
                    this.displayRandomBanner();
                });

            // cleanup on page unload
            window.addEventListener('beforeunload', () => {
                this.destroy();
            });
        }

        createElements() {
            this.container = document.createElement("div");
            this.imageElement = document.createElement("img");
            this.clickIndicator = document.createElement("div");

            this.container.id = "bottomBar";
            this.container.setAttribute('tabindex', '0');
            this.container.setAttribute('role', 'button');
            this.container.setAttribute('aria-label', 'Click to change banner');

            this.container.style.cssText = `
                height: ${CONFIG.bannerHeight}px;
                font-size: 12px;
                border-style: none;
                border-width: 5px;
                background-color: transparent;
                padding: 0;
                margin: 0 .3em 1em 2em;
                position: relative;
                overflow: hidden;
                cursor: pointer;
                transition: transform 200ms ease-in-out, box-shadow 200ms ease-in-out;
                user-select: none;
                border-radius: 3px;
            `;

            this.imageElement.style.cssText = `
                width: 100%; 
                height: 100%; 
                object-fit: contain; 
                display: block;
                transition: opacity ${CONFIG.fadeTransition}ms ease-in-out;
                pointer-events: none;
            `;

            this.clickIndicator.style.cssText = `
                position: absolute;
                top: 2px;
                right: 4px;
                width: 16px;
                height: 16px;
                background: rgba(255, 255, 255, 0.8);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 10px;
                font-weight: bold;
                color: #333;
                opacity: 0;
                transition: opacity 200ms ease-in-out, transform 150ms ease-in-out;
                pointer-events: none;
                z-index: 10;
                box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            `;
            this.clickIndicator.textContent = "↻";

            // append elements
            this.container.appendChild(this.imageElement);
            this.container.appendChild(this.clickIndicator);
            gameWindow.insertAdjacentElement("afterend", this.container);
        }

        setupEventListeners() {
            this.container.onclick = (e) => {
                e.preventDefault();
                const now = Date.now();
                if (now - this.lastClickTime < CONFIG.clickCooldown || this.isTransitioning) {
                    return;
                }
                this.lastClickTime = now;
                this.nextBanner();
            };

            // hover effects
            if (CONFIG.hoverEffect) {
                this.container.onmouseenter = () => {
                    if (this.isTransitioning) return;
                    
                    cancelAnimationFrame(this.rafId);
                    this.rafId = requestAnimationFrame(() => {
                        this.container.style.transform = 'scale(1.02)';
                        this.container.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                        this.clickIndicator.style.opacity = '1';
                    });
                };

                this.container.onmouseleave = () => {
                    cancelAnimationFrame(this.rafId);
                    this.rafId = requestAnimationFrame(() => {
                        this.container.style.transform = 'scale(1)';
                        this.container.style.boxShadow = 'none';
                        this.clickIndicator.style.opacity = '0';
                    });
                };
            }

            // keyboard accessibility
            this.container.onkeydown = (e) => {
                if (e.code === 'Space' || e.code === 'Enter') {
                    e.preventDefault();
                    this.nextBanner();
                }
            };
        }

        async preloadInitialBanners() {
            // prioritize preloading based on banner weights
            const sortedBanners = [...banners]
                .sort((a, b) => b.weight - a.weight)
                .slice(0, CONFIG.preloadCount);
                
            const urlsToPreload = sortedBanners.map(b => b.url);
            return this.cache.preloadBatch(urlsToPreload);
        }

        async displayBanner(banner, useTransition = false) {
            if (this.isTransitioning) return;

            const cachedImg = this.cache.getCachedImage(banner.url);

            if (useTransition && CONFIG.fadeTransition > 0) {
                this.isTransitioning = true;
                this.imageElement.style.opacity = '0';

                setTimeout(() => {
                    requestAnimationFrame(() => {
                        if (cachedImg) {
                            this.imageElement.src = cachedImg.src;
                        } else {
                            this.imageElement.src = banner.url;
                        }
                        this.imageElement.alt = banner.alt;
                        
                        // force reflow to ensure transition works
                        void this.imageElement.offsetWidth;
                        this.imageElement.style.opacity = '1';
                        this.isTransitioning = false;
                    });
                }, CONFIG.fadeTransition / 2);
            } else {
                requestAnimationFrame(() => {
                    if (cachedImg) {
                        this.imageElement.src = cachedImg.src;
                    } else {
                        this.imageElement.src = banner.url;
                    }
                    this.imageElement.alt = banner.alt;
                });
            }

            this.currentBanner = banner;

            // track recent banners
            this.recentBanners.push(banner.url);
            if (this.recentBanners.length > 3) {
                this.recentBanners.shift();
            }

            // preload next banner if not cached
            if (!cachedImg) {
                this.cache.preloadImage(banner.url).catch(() => {
                    // silent fail
                });
            }

            // opportunistically preload next potential banners
            if (CONFIG.useRequestIdleCallback && window.requestIdleCallback) {
                window.requestIdleCallback(() => {
                    const nextBanners = banners
                        .filter(b => !this.recentBanners.includes(b.url) && !this.cache.imageCache.has(b.url))
                        .sort((a, b) => b.weight - a.weight)
                        .slice(0, 2);
                        
                    this.cache.preloadBatch(nextBanners.map(b => b.url));
                }, { timeout: 5000 });
            }
        }

        displayRandomBanner() {
            const banner = bannerSelector.getRandomBanner(this.recentBanners);
            this.displayBanner(banner, this.currentBanner !== null);
        }

        nextBanner() {
            this.displayRandomBanner();

            requestAnimationFrame(() => {
                this.clickIndicator.style.transform = 'scale(1.2)';
                
                setTimeout(() => {
                    requestAnimationFrame(() => {
                        this.clickIndicator.style.transform = 'scale(1)';
                    });
                }, 150);
            });
        }

        destroy() {
            cancelAnimationFrame(this.rafId);
            
            if (this.container) {
                this.container.onclick = null;
                this.container.onmouseenter = null;
                this.container.onmouseleave = null;
                this.container.onkeydown = null;
                
                if (this.container.parentNode) {
                    this.container.parentNode.removeChild(this.container);
                }
            }
            
            this.container = null;
            this.imageElement = null;
            this.clickIndicator = null;
        }
    }

    const bannerSystem = new ClickableBannerSystem();

    window.vintageBannerSystem = {
        next: () => bannerSystem.nextBanner(),
        current: () => bannerSystem.currentBanner?.alt || 'Loading...'
    };
})();

// Tooltips. They first came from 2021DE if I'm not mistaken, although I took these tooltips from 2022 Ohio Senate. It's been significantly modified from what they were previously, though.

function addDynamicCSS() {
  const css = `
      .mytooltip {
          position: relative;
          display: inline-block;
          font-weight: bold;
          font-size: 1em;
          line-height: inherit;
          cursor: pointer;
          text-decoration: underline;
          text-shadow: 0 0 3px rgba(0, 255, 255, 0.3), 1px 1px 1px rgba(0,0,0,0.5);
          transition: text-shadow 0.3s ease, color 0.3s ease;
          color: color-contrast(var(--bg, #fff) vs #000, #fff);
      }

      .mytooltip:hover {
          text-shadow: 0 0 6px rgba(0, 255, 255, 0.5), 1px 1px 1px rgba(0,0,0,0.5);
      }

      @keyframes glowPulse {
          0%,100% { box-shadow: 0 0 10px rgba(0,255,255,0.4); }
          50% { box-shadow: 0 0 16px rgba(0,255,255,0.6); }
      }

      .mytooltip .mytooltiptext {
          opacity: 0;
          visibility: hidden;
          background: #1a242a;
          border: 2px solid #4fc3f7;
          text-align: center;
          padding: 8px 12px;
          border-radius: 8px;
          position: absolute;
          z-index: 1000;
          bottom: 125%;
          left: 50%;
          transform: translateX(-50%);
          white-space: normal;
          max-width: 260px;
          width: max-content;
          font-family: 'Segoe UI', Tahoma, sans-serif;
          font-weight: 600;
          letter-spacing: 0.4px;
          color: #ffffff;
          text-shadow: 0 0 3px rgba(0,255,255,0.4), 1px 1px 1px rgba(0,0,0,0.5);
          will-change: opacity, box-shadow;
          transition: opacity 0.45s ease, visibility 0s linear 0.45s;
      }

      .mytooltip.show .mytooltiptext {
          visibility: visible;
          opacity: 1;
          transition-delay: 0s;
          animation: glowPulse 1.5s ease-in-out infinite alternate;
      }

      .mytooltip.hide .mytooltiptext {
          opacity: 0;
          visibility: hidden;
          transition-delay: 0s, 0.45s;
      }

      .mytooltip img {
          display: block;
          margin: 8px auto 0 auto;
          max-width: 100%;
          height: auto;
          border: 2px solid #4fc3f7;
          border-radius: 6px;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          background: none !important;
      }
  `;

  const styleElem = document.createElement('style');
  styleElem.type = 'text/css';
  styleElem.appendChild(document.createTextNode(css));
  document.head.appendChild(styleElem);

  document.body.addEventListener('mouseenter', e => {
      const el = e.target.closest('.mytooltip');
      if (!el) return;
      el.classList.remove('hide');
      el.classList.add('show');
  }, true);

  document.body.addEventListener('mouseleave', e => {
      const el = e.target.closest('.mytooltip');
      if (!el) return;
      el.classList.remove('show');
      el.classList.add('hide');
  }, true);
}

addDynamicCSS();

tooltipList = [
  {searchString: "Donald Trump", explanationText: "<img src=https://i.imgur.com/LzbPeXB.png> That rich guy from New York, and one of your primary rivals."},
  {searchString: "Hillary Clinton", explanationText: "<img src=https://i.imgur.com/m4u5J6q.png> Leader of Planned Parenthood, gay marriage, and the Democratic deep state.<br>You must stop her."},
  {searchString: "Rubio", explanationText: "<img src=https://i.imgur.com/GXOGkB4.png> Marco Rubio, Senator from Florida. He was once known as a Tea Party conservative, but those days are long gone."},
  {searchString: "Senator Rubio", explanationText: "<img src=https://i.imgur.com/GXOGkB4.png> Marco Rubio, Senator from Florida. He was once known as a Tea Party conservative, but those days are long gone."},
  {searchString: "Barack Obama", explanationText: "<img src=https://i.imgur.com/SGb8x0z.png> His term is coming to an end.<br>He spends his days destroying the Constitution and violating personal freedoms."},
  {searchString: "Bernie Sanders", explanationText: "<img src=https://i.imgur.com/jaM9ZbG.jpeg> Atleast he's honest about being a communist."},
  {searchString: "Roe v. Wade", explanationText: "<img src=https://i.imgur.com/eens7WG.jpeg> The greatest tragedy in the history of our nation."},
  {searchString: "Obamacare", explanationText: "<img src=https://i.imgur.com/FcGHKb0.jpeg> Clear proof that Obama is a communist."},
  {searchString: "the establishment", explanationText: "<img src=https://i.imgur.com/BHYdwFO.png>"},
  {searchString: "Ben Carson", explanationText: "<img src=https://i.imgur.com/mk57VPA.png> Ben Carson – A neurosurgeon, well known in the Evangelical community."},
  {searchString: "Walker", explanationText: "<img src=https://i.imgur.com/xmf05Zy.jpeg> That guy who survived the recall."},
  {searchString: "LGBT nightclub in Orlando killed 49", explanationText: "<img src=https://i.imgur.com/Fx5c1jK.jpeg> Pulse Nightclub in Orlando, Florida, while it still existed."},
  {searchString: "Kasich", explanationText: "<img src=https://i.imgur.com/YcCbaxa.jpeg> John Kasich – Governor of Ohio and avowed moderate candidate."},
  {searchString: "Governor Kasich", explanationText: "<img src=https://i.imgur.com/YcCbaxa.jpeg> John Kasich – Governor of Ohio and avowed moderate candidate."},
  {searchString: "Secretary of State", explanationText: "<img src=https://i.imgur.com/VCoZIYr.png> Extremely corrupt!"},
  {searchString: "21-hour Senate filibuster", explanationText: "<img src=https://i.imgur.com/nD2r4i8.jpeg> From October 1 to October 17, 2013, the United States federal government entered a shutdown when the Republican-held House tried to defund Obamacare in the next annual appropriation bill, while the Democratic-controlled Senate refused. You played a large part in sparking the flames."},
  {searchString: "Heidi", explanationText: "<img src=https://i.imgur.com/EEYIvuQ.jpeg> Wife. The better half, and the one with fewer enemies."},
  {searchString: "radical Islamist terrorist attack in Nice, France left 86 dead and 450 injured.", explanationText: "<img src=https://i.imgur.com/bh8d5AS.jpeg> A radical terrorist from Tunisia used a rented truck to run over a crowd while people were celebrating Bastille Day in Nice, France."},
  {searchString: "Holt", explanationText: "<img src=https://i.imgur.com/U4vKTzh.png> The guy who is moderating your debate. Doesn't help that he's a puppet for the puppet masters."},
  {searchString: "Lester Holt", explanationText: "<img src=https://i.imgur.com/U4vKTzh.png> The guy who is moderating your debate. Doesn't help that he's a puppet for the puppet masters."},
  {searchString: "Mitt Romney", explanationText: "<img src=https://i.postimg.cc/MHgDf0j2/Romney.jpg> Doesn't talk much nowadays. He's a good guy, but he was unable to stop the Democratic deep state. You will though."},
  {searchString: "Pawlenty", explanationText: "<img src=https://i.imgur.com/AizWq7q.png> Timothy J. Pawlenty, Former Governor of Minnesota. Moderate, perhaps a bit too moderate, but far better then those socialist Democrats."},
  {searchString: "Tim Pawlenty", explanationText: "<img src=https://i.imgur.com/AizWq7q.png> Timothy J. Pawlenty, Former Governor of Minnesota. Moderate, perhaps a bit too moderate, but far better then the socialists your facing."},
  {searchString: "Governor Pawlenty", explanationText: "<img src=https://i.imgur.com/AizWq7q.png> Timothy J. Pawlenty, Former Governor of Minnesota. Moderate, perhaps a bit too moderate, but far better then those socialists your facing."},
  {searchString: "Portman", explanationText: "<img src=https://i.imgur.com/Q9C0H1g.png> Senator from Ohio, swept into the Senate in the Tea Party wave, much like you."},
  {searchString: "Senator Portman", explanationText: "<img src=https://i.imgur.com/Q9C0H1g.png> Senator from Ohio, swept into the Senate in the Tea Party wave, much like you."},
  {searchString: "Rob Portman", explanationText: "<img src=https://i.imgur.com/Q9C0H1g.png> Senator from Ohio, swept into the Senate in the Tea Party wave, much like you."},
  {searchString: "Jeff Roe", explanationText: "<img src=https://i.postimg.cc/90khJt8G/Jeffnted.png> Jeff Roe, Chief Campaign Manager, and a good friend of yours."},
  {searchString: "Jeff", explanationText: "<img src=https://i.postimg.cc/90khJt8G/Jeffnted.png> Jeff Roe, Chief Campaign Manager, and a good friend of yours."},
  {searchString: "Carly Fiorina", explanationText: "<img src=https://i.imgur.com/JCWFk3t.png> Former CEO of Hewlett-Packard from 1999 to 2005."},
  {searchString: "Chelsea", explanationText: "<img src=https://i.imgur.com/gXrY6co.png> Hillary's annoying daughter that won't shut up."},
  {searchString: "Hillary's just as sick as her husband.", explanationText: "<img src=https://i.imgur.com/Fnc6aZi.jpeg>Monica-Lewinsky. I was just an Attorney back then. Simpler times."},
  {searchString: "Vince Foster", explanationText: "<img src=https://i.imgur.com/iQoKmB9.jpeg>Hillary's smile. The smile of a murderer."},
  {searchString: "As the Presidential debate ends", explanationText: "<img src=https://i.imgur.com/byExr6Z.png>I easily won that debate, but of course, the biased news networks will say otherwise."},
  {searchString: "Benghazi", explanationText: "<img src=https://i.imgur.com/XtSnrAP.jpeg> This is the work of our so-called experienced Secretary of State."},
  {searchString: "phone", explanationText: "<img src=https://i.imgur.com/brGdIvB.png>Hillary doesn't even know how to hold one! Ha. “Hey, Heidi, how do I go on YouTube again?”"},
  {searchString: "phones", explanationText: "<img src=https://i.imgur.com/brGdIvB.png>Hillary doesn't even know how to hold one! Ha. “Hey, Heidi, how do I go on YouTube again?”"},
  {searchString: "foundation", explanationText: "<img src=https://i.imgur.com/aSizgGM.jpeg>So called “charity” that receives millions from Russia and Saudi Arabia."},
  {searchString: "Speaker Ryan", explanationText: "<img src=https://i.imgur.com/QDPssVv.jpeg>Romney's running mate in 2012, and Speaker of the House."},
  {searchString: "Placeholder", explanationText: "<img src=https://i.imgur.com/PUT IMGUR LINK HERE> Put the Text Here"},
  {searchString: "Placeholder 2", explanationText: "<img src=https://i.imgur.com/PUT IMGUR LINK HERE> Put the Text Here"}
      
];


